<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Formulário de Resgate</title>
    <link rel="stylesheet" href="formulario.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.2.1/axios.min.js"></script>
  </head>

  <body>
    <div class="container">
      <div class="botao">
        <h1>Formulário de Resgate</h1>
        <button
          class="btn-tooltip"
          aria-label="Formulário para solicitar um resgate, complete os dados solicitados corretamente para recebemos a sua solicitação!"
        >
          ?
        </button>
      </div>

      <form id="rescue-form" method="post" action="/api/rescueRequests">
        <label for="nome">Nome:</label>
        <input
          type="text"
          id="nome"
          name="name"
          required
          placeholder="Exemplo: João da Silva"
        />

        <label for="email">E-mail:</label>
        <input
          type="email"
          id="email"
          name="email"
          required
          placeholder="Exemplo: joao.silva80@gmail.com"
        />

        <label for="telefone">Telefone:</label>
        <input
          type="tel"
          id="telefone"
          name="phone"
          pattern="\(\d{2}\) \d{5}-\d{4}"
          required
          placeholder="Exemplo: (41) 99929-9921"
        />

        <label for="endereco">Endereço:</label>
        <input
          type="text"
          id="endereco"
          name="address"
          required
          placeholder="Rua, Número - Bairro - Cidade/Estado - CEP"
        />

        <label for="caracteristicas">Características do Gato:</label>
        <textarea
          id="caracteristicas"
          name="characteristics"
          rows="4"
          required
          placeholder="Exemplo: Gato amarelo e macho"
        ></textarea>

        <label for="observacoes">Observações:</label>
        <textarea
          id="observacoes"
          name="observations"
          rows="4"
          required
          placeholder="Exemplo: Gato muito magro e com algumas feridas no corpo"
        ></textarea>

        <input type="submit" value="RESGATAR" />
      </form>
    </div>

    <script>
      function formatarTelefone(input) {
        var numeros = input.value.replace(/\D/g, "");
        var formatado = "";

        if (numeros.length > 0) {
          formatado = "(" + numeros.substring(0, 2);

          if (numeros.length > 2) {
            formatado += ") " + numeros.substring(2, 7);
          }

          if (numeros.length > 7) {
            formatado += "-" + numeros.substring(7, 11);
          }
        }

        input.value = formatado;
      }

      let campoTelefone = document.getElementById("telefone");
      campoTelefone.addEventListener("input", function () {
        formatarTelefone(this);
      });

      document
        .getElementById("rescue-form")
        .addEventListener("submit", function (e) {
          const rescueFormData = new FormData(this);
          const jsonData = JSON.stringify(Object.fromEntries(rescueFormData));

          fetch("/api/rescueRequests", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: jsonData,
          }).then((response) => response.json());
        });
    </script>
  </body>
</html>
